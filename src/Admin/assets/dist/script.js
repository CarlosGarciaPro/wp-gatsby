"use strict";/**
 * This file is printed out in preview-template.php
 * initialState global comes from preview-template.php above where this is printed to the page
 */try{var updateLoaderWarning=function(a){var b=document.getElementById("preview-loader-warning");b.innerHTML="".concat(a,"<br /><br /><button onclick=\"cancelPreviewLoader()\">Cancel and Troubleshoot</button>"),b.style.display="initial"},cancelPreviewLoader=function(){showError("Preview was cancelled.")},fetchPreviewStatusAndUpdateUI=function(){var a=0<arguments.length&&arguments[0]!==void 0?arguments[0]:{},b=a.ignoreNoIndicationOfSourcing;fetch(initialState.previewFrontendUrl+"/__wpgatsby-preview-status",{method:"POST",body:JSON.stringify({nodeId:initialState.nodeId,modified:initialState.modified,ignoreNoIndicationOfSourcing:void 0!==b&&b}),headers:{"Content-Type":"application/json"}}).then(function(a){return a.json()}).then(function(a){onPreviewReady(a)}).catch(function(a){"string"==typeof a&&a.str_post("Unexpected token < in JSON at position 0")&&(a+="\n\nYour version of gatsby-source-wordpress-experimental is likely out of date.\n\nPlease upgrade to the latest version."),showError(a)})},displayNoIndicationOfSourcingWarningAndTryAgain=function(){noIndicationOfSourcingWarningTimeout=setTimeout(function(){updateLoaderWarning("There is no indication that preview data is being sourced by the server.<br /><br />A code change for this website might be deploying and blocking preview from working.<br /><br /><b>Please try pressing \"preview\" in WordPress again.</b><br />If you see this message again, wait 5 - 10 minutes and then try again,<br />or contact your developer for help.")},timeoutMilliseconds),fetchPreviewStatusAndUpdateUI({ignoreNoIndicationOfSourcing:!0})},onPreviewReady=function(a){if(clearTimeout(timeoutWarning),a.type&&"NOT_IN_PREVIEW_MODE"===a.type)throw new Error("Your Gatsby site is not in Preview mode.\nIf you're hosting on Gatsby Cloud, please see below for where to contact support.\nIf you're running Previews locally or are self-hosting, please refer to https://www.gatsbyjs.com/docs/refreshing-content to put Gatsby into Preview mode.");if(a.type&&"NO_INDICATION_OF_SOURCING"===a.type)return displayNoIndicationOfSourcingWarningAndTryAgain();if(console.log("Received a response:"),console.log(a),!a.type||!a.payload||!a.payload.pageNode||!a.payload.pageNode.path)throw new Error("Received an improper response from the Preview server.");var b=document.getElementById("preview");b.addEventListener("load",onIframeLoaded),b.src=initialState.previewFrontendUrl+a.payload.pageNode.path,noIndicationOfSourcingWarningTimeout||clearTimeout(noIndicationOfSourcingWarningTimeout)},onIframeLoaded=function(){var a=document.getElementById("loader");// this delay prevents a flash between
// the iframe painting and the loader dissapearing
setTimeout(function(){// there is a fadeout css animation on this
a.classList.add("loaded"),setTimeout(function(){// we wait a sec to display none so the css animation fadeout can complete
a.style.display="none"},100)},50)},timeoutSeconds=45,timeoutMilliseconds=1e3*timeoutSeconds,timeoutWarning=setTimeout(function(){updateLoaderWarning("Preview is taking a very long time to load (more than ".concat(timeoutSeconds," seconds).<br />Try pressing \"preview\" again from the WordPress edit screen.<br />If you see this again, your preview builds are either slow or there's something wrong."))},timeoutMilliseconds);fetchPreviewStatusAndUpdateUI();var noIndicationOfSourcingWarningTimeout}catch(a){document.addEventListener("DOMContentLoaded",function(){showError(a)})}function showError(a){var b=document.getElementById("preview");b.style.display="none";var c=document.getElementById("loader");c.style.display="none";var d=document.getElementById("error-message-element");d.textContent=a;var e=document.querySelector(".content.error");e.style.display="block"}